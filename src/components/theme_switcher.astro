---
// src/components/theme_switcher.astro
// Un composant minimaliste pour basculer entre 4 thèmes

// Définir les thèmes disponibles
const themes = [
  {
    id: "ocean",
    name: "Océan",
    type: "light"
  },
  {
    id: "nature",
    name: "Nature",
    type: "light"
  },
  {
    id: "midnight",
    name: "Minuit",
    type: "dark"
  },
  {
    id: "forest",
    name: "Forêt",
    type: "dark"
  },
];
---

<div class="theme-switcher">
  {
    themes.map((theme) => (
      <button
        class={`theme-btn ${theme.type}`}
        data-theme={theme.id}
        title={theme.name}
        aria-label={`Thème ${theme.name}`}
      >
        {theme.id.charAt(0).toUpperCase()}
      </button>
    ))
  }
</div>

<script>
  // Script côté client pour changer le thème (sans réinitialisation à chaque chargement)
  document.addEventListener("DOMContentLoaded", () => {
    const themeButtons = document.querySelectorAll(".theme-btn");
    
    // Récupérer le thème actuel depuis l'attribut data-theme sur html
    const currentTheme = document.documentElement.getAttribute("data-theme");
    
    // Mettre à jour l'UI pour montrer le thème actif
    if (currentTheme) {
      themeButtons.forEach((btn) => {
        if (btn.getAttribute("data-theme") === currentTheme) {
          btn.classList.add("active");
        } else {
          btn.classList.remove("active");
        }
      });
    }

    // Ajouter les écouteurs d'événements pour le changement de thème
    themeButtons.forEach((button) => {
      const themeId = button.getAttribute("data-theme");

      if (themeId !== null) {
        button.addEventListener("click", () => {
          // Mettre à jour la classe active
          themeButtons.forEach((btn) => btn.classList.remove("active"));
          button.classList.add("active");
          
          // Appliquer le thème
          document.documentElement.setAttribute("data-theme", themeId);
          localStorage.setItem("selected-theme", themeId);
        });
      }
    });
  });
</script>

<style>
  .theme-switcher {
    display: flex;
    gap: 4px;
  }

  .theme-btn {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    font-weight: bold;
    font-size: 11px;
    cursor: pointer;
    border: 1px solid var(--color-border);
    background-color: var(--bg-color);
    color: var(--color-primary);
    transition: all 0.2s ease;
  }

  .theme-btn.active {
    border-color: var(--color-accent);
    transform: scale(1.1);
  }
  
  .theme-btn.light {
    background-color: #f0f4f8;
    color: #1a4d7c;
  }
  
  .theme-btn.dark {
    background-color: #1f2937;
    color: #6889c2;
  }
</style>